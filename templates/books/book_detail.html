{% extends 'base.html' %}

{% block title %}
    {{ book.title }}
{% endblock %}

{% block content %}
    {% if book.image %}
    <img style="width: 100px; height: 100px" src="{{ book.image.url }}">
    {% endif %}

    <h1>{{ book.title }}</h1>
    <h2>{{ book.author }}</h2>
    <br>
    <p>Год: {{ book.year }}</p>
    <p>Рейтинг: {{ book.raiting }}</p>

    <p>Издатель: {{ book.publisher.title }}</p>
    <p>Язык: {{ book.publisher.get_language_display }}</p>

    {% if book.genre %}

    <p>Жанр: {{ book.genre.title }}</p>

    {% else %}

    <p>Жанр: не указан</p>

    {% endif %}

    <p>Время публикации на сайте: {{ book.created_at }}</p>

    <p>Теги: </p>

    {% for tag in book.tags.all %}
        <b> <a href="{% url 'get_tag_books' tag.title %}"> {{ tag.title }} </a> </b>
    {% endfor %}

    <p>Добавил на сайт: {{ book.user.username }}</p>

    <p>Цена: {{ book.price }}</p>

    {% if book.count > 0 %}

    <a href="{% url 'buy_book' book.id %}">Купить книгу</a>

    {% else %}

    <h3>Книг на складе не осталось</h3>

    {% endif %}

    {% if request.user.is_authenticated and show_favorite_button %}

    <a href="{% url 'favorite_book' book.id %}">Добавить в избранное</a>

    {% elif not request.user.is_authenticated%}

    {% else %}

    <p>Добавлено в избранное</p>

    {% endif %}

    <br>
    <br>
    <hr>

    {% if request.user.username == book.user.username %}

    <a href="{% url 'update_book_by_id' book.id %}">Редактировать</a>
    <a href="{% url 'delete_book' book.id %}">Удалить книгу</a>

    {% endif %}

    <br>
    <br>

    {% if request.user.is_authenticated %}
        <form action="{% url 'add_comment' book.id %}" method="post">
                {% csrf_token %}

                <textarea name="comment"></textarea>

                <input type="submit" value="Добавить комментарий!">
        </form>
    {% endif %}

    <br>

    {% for comment in book.comments.all %}
        <div style="border: 1px solid black; width: 300px; margin-bottom: 10px; padding: 10px;">
            <p>{{ comment.content }}</p>
            <p>{{ comment.user }}</p>
            <p>{{ comment.date_created }}</p>
        </div>

    {% endfor %}

{% endblock %}

